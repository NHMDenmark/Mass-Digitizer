[
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "taxonspid",
    "expression": "grel:if((value==null).or(value==0), 1, 0)",
    "onError": "set-to-blank",
    "newColumnName": "newtaxonflag",
    "columnInsertIndex": 11,
    "description": "Create column newtaxonflag at index 11 based on column taxonspid using expression grel:if((value==null).or(value==0), 1, 0)"
  },
  {
    "op": "core/column-rename",
    "oldColumnName": "multispecimen",
    "newColumnName": "containername",
    "description": "Rename column multispecimen to containername"
  },
  {
    "op": "core/column-split",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "storagefullname",
    "guessCellType": true,
    "removeOriginalColumn": true,
    "mode": "separator",
    "separator": " | ",
    "regex": false,
    "maxColumns": 0,
    "description": "Split column storagefullname by separator"
  },
  {
    "op": "core/column-rename",
    "oldColumnName": "storagefullname 1",
    "newColumnName": "institution",
    "description": "Rename column storagefullname 1 to institution"
  },
  {
    "op": "core/column-rename",
    "oldColumnName": "storagefullname 2",
    "newColumnName": "site",
    "description": "Rename column storagefullname 2 to site"
  },
  {
    "op": "core/column-rename",
    "oldColumnName": "storagefullname 3",
    "newColumnName": "collection",
    "description": "Rename column storagefullname 3 to collection"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "taxonfullname",
    "expression": "grel:if(cells['rankid'].value >= 180, value.split(' ')[0], '')",
    "onError": "set-to-blank",
    "newColumnName": "genus",
    "columnInsertIndex": 5,
    "description": "Create column genus at index 5 based on column taxonfullname using expression grel:if(cells['rankid'].value >= 180, value.split(' ')[0], '')"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "taxonfullname",
    "expression": "grel:if(cells['rankid'].value >= 220, value.split(' ')[1], '')",
    "onError": "set-to-blank",
    "newColumnName": "species",
    "columnInsertIndex": 5,
    "description": "Create column species at index 5 based on column taxonfullname using expression grel:if(cells['rankid'].value >= 220, value.split(' ')[1], '')"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "taxonfullname",
    "expression": "grel:if(cells['rankid'].value == 230, value.split(' ')[2], '')",
    "onError": "set-to-blank",
    "newColumnName": "subspecies",
    "columnInsertIndex": 5,
    "description": "Create column subspecies at index 5 based on column taxonfullname using expression grel:if(cells['rankid'].value == 230, value.split(' ')[2], '')"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "taxonfullname",
    "expression": "grel:if(cells['rankid'].value == 240, value.split(' ')[3], '')",
    "onError": "set-to-blank",
    "newColumnName": "variety",
    "columnInsertIndex": 5,
    "description": "Create column variety at index 5 based on column taxonfullname using expression grel:if(cells['rankid'].value == 240, value.split(' ')[3], '')"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "variety",
    "expression": "grel:if(cells[\"taxonfullname\"].value.contains(\"var.\"), cells[\"taxonfullname\"].value.split(' ')[3], value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Text transform on cells in column variety using expression grel:if(cells[\"taxonfullname\"].value.contains(\"var.\"), cells[\"taxonfullname\"].value.split(' ')[3], value)"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "taxonfullname",
    "expression": "grel:if(cells['rankid'].value == 260, value.split(' ')[3], '')",
    "onError": "set-to-blank",
    "newColumnName": "forma",
    "columnInsertIndex": 5,
    "description": "Create column forma at index 5 based on column taxonfullname using expression grel:if(cells['rankid'].value == 260, value.split(' ')[3], '')"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "forma",
    "expression": "grel:if(cells[\"taxonfullname\"].value.contains(\" forma \"), cells[\"taxonfullname\"].value.split(' ')[3], value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Text transform on cells in column forma using expression grel:if(cells[\"taxonfullname\"].value.contains(\" forma \"), cells[\"taxonfullname\"].value.split(' ')[3], value)"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "forma",
    "expression": "grel:if(cells[\"taxonfullname\"].value.contains(\" f\\. \"), cells[\"taxonfullname\"].value.split(' ')[3], value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Text transform on cells in column forma using expression grel:if(cells[\"taxonfullname\"].value.contains(\" f\\. \"), cells[\"taxonfullname\"].value.split(' ')[3], value)"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "forma",
    "expression": "grel:if(cells[\"taxonfullname\"].value.contains(\" f\\. \"), cells[\"taxonfullname\"].value.split(' ')[3], value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Text transform on cells in column forma using expression grel:if(cells[\"taxonfullname\"].value.contains(\" f\\. \"), cells[\"taxonfullname\"].value.split(' ')[3], value)"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "newtaxonflag",
    "expression": "grel:if((value==1).and(cells['taxonfullname'].value.contains(' forma ')), 1, 0)",
    "onError": "set-to-blank",
    "newColumnName": "newformaflag",
    "columnInsertIndex": 17,
    "description": "Create column newformaflag at index 17 based on column newtaxonflag using expression grel:if((value==1).and(cells['taxonfullname'].value.contains(' forma ')), 1, 0)"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "newformaflag",
    "expression": "grel:if((cells['newtaxonflag'].value==1).and(cells['taxonfullname'].value.contains(' f\\. ')), 1, value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Text transform on cells in column newformaflag using expression grel:if((cells['newtaxonflag'].value==1).and(cells['taxonfullname'].value.contains(' f\\. ')), 1, value)"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "newtaxonflag",
    "expression": "grel:if((cells['newtaxonflag'].value==1).and(cells['taxonfullname'].value.contains(' var\\. ')), 1, 0)",
    "onError": "set-to-blank",
    "newColumnName": "newvarietyflag",
    "columnInsertIndex": 17,
    "description": "Create column newvarietyflag at index 17 based on column newtaxonflag using expression grel:if((cells['newtaxonflag'].value==1).and(cells['taxonfullname'].value.contains(' var\\. ')), 1, 0)"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [
        {
          "type": "range",
          "name": "newtaxonflag",
          "expression": "value",
          "columnName": "newtaxonflag",
          "from": 0.92,
          "to": 1.01,
          "selectNumeric": true,
          "selectNonNumeric": true,
          "selectBlank": true,
          "selectError": true
        }
      ],
      "mode": "row-based"
    },
    "baseColumnName": "newtaxonflag",
    "expression": "grel:if((cells['newtaxonflag'].value==1).and(cells['taxonfullname'].value.split(' ').length()==3), 1, 0)",
    "onError": "set-to-blank",
    "newColumnName": "newsubspeciesflag",
    "columnInsertIndex": 17,
    "description": "Create column newsubspeciesflag at index 17 based on column newtaxonflag using expression grel:if((cells['newtaxonflag'].value==1).and(cells['taxonfullname'].value.split(' ').length()==3), 1, 0)"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [
        {
          "type": "range",
          "name": "newtaxonflag",
          "expression": "value",
          "columnName": "newtaxonflag",
          "from": 0.92,
          "to": 1.01,
          "selectNumeric": true,
          "selectNonNumeric": true,
          "selectBlank": true,
          "selectError": true
        }
      ],
      "mode": "row-based"
    },
    "baseColumnName": "newtaxonflag",
    "expression": "grel:if((cells['newtaxonflag'].value==1).and(cells['taxonfullname'].value.split(' ').length()==2), 1, 0)",
    "onError": "set-to-blank",
    "newColumnName": "newspeciesflag",
    "columnInsertIndex": 17,
    "description": "Create column newspeciesflag at index 17 based on column newtaxonflag using expression grel:if((cells['newtaxonflag'].value==1).and(cells['taxonfullname'].value.split(' ').length()==2), 1, 0)"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [
        {
          "type": "range",
          "name": "newtaxonflag",
          "expression": "value",
          "columnName": "newtaxonflag",
          "from": 0.92,
          "to": 1.01,
          "selectNumeric": true,
          "selectNonNumeric": true,
          "selectBlank": true,
          "selectError": true
        }
      ],
      "mode": "row-based"
    },
    "baseColumnName": "newtaxonflag",
    "expression": "grel:if((cells['newtaxonflag'].value==1).and(cells['taxonfullname'].value.split(' ').length()==1), 1, 0)",
    "onError": "set-to-blank",
    "newColumnName": "newgenusflag",
    "columnInsertIndex": 17,
    "description": "Create column newgenusflag at index 17 based on column newtaxonflag using expression grel:if((cells['newtaxonflag'].value==1).and(cells['taxonfullname'].value.split(' ').length()==1), 1, 0)"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "genus",
    "expression": "grel:if(cells['taxonfullname'].value.split(' ').length()>1, cells['taxonfullname'].value.split(' ')[0], value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Text transform on cells in column genus using expression grel:if(cells['taxonfullname'].value.split(' ').length()>1, cells['taxonfullname'].value.split(' ')[0], value)"
  },
  {
    "op": "core/column-rename",
    "oldColumnName": "familyname",
    "newColumnName": "family",
    "description": "Rename column familyname to family"
  },
  {
    "op": "core/column-reorder",
    "columnNames": [
      "id",
      "spid",
      "catalognumber",
      "containername",
      "taxonfullname",
      "family",
      "genus",
      "species",
      "subspecies",
      "variety",
      "forma",
      "taxonname",
      "taxonnameid",
      "taxonrankname",
      "rankid",
      "taxonspid",
      "newtaxonflag",
      "newgenusflag",
      "newspeciesflag",
      "newsubspeciesflag",
      "newvarietyflag",
      "newformaflag",
      "highertaxonname",
      "typestatusname",
      "typestatusid",
      "georegionname",
      "georegionid",
      "institution",
      "site",
      "collection",
      "storagename",
      "storageid",
      "storagerankname",
      "preptypename",
      "preptypeid",
      "notes",
      "institutionid",
      "institutionname",
      "collectionid",
      "collectionname",
      "username",
      "userid",
      "recorddatetime",
      "exported",
      "exportdatetime",
      "exportuserid",
      "agentfirstname",
      "agentmiddleinitial",
      "agentlastname"
    ],
    "description": "Reorder columns"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "species",
    "expression": "grel:if(cells['taxonfullname'].value.split(' ').length()>1, cells['taxonfullname'].value.split(' ')[1], value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Text transform on cells in column species using expression grel:if(cells['taxonfullname'].value.split(' ').length()>1, cells['taxonfullname'].value.split(' ')[1], value)"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "storagename",
    "expression": "grel:if(value.split(' ')[0] == 'Shelf', value.split(' ')[1], '')",
    "onError": "set-to-blank",
    "newColumnName": "shelf",
    "columnInsertIndex": 31,
    "description": "Create column shelf at index 31 based on column storagename using expression grel:if(value.split(' ')[0] == 'Shelf', value.split(' ')[1], '')"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "storagename",
    "expression": "grel:if(value.split(' ')[0] == 'Box', value.split(' ')[1], '')",
    "onError": "set-to-blank",
    "newColumnName": "box",
    "columnInsertIndex": 31,
    "description": "Create column box at index 31 based on column storagename using expression grel:if(value.split(' ')[0] == 'Box', value.split(' ')[1], '')"
  }
]